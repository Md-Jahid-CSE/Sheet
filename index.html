<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restricted Presentation Team Entry</title>
    <style>
        /* Styles omitted for brevity */
    </style>
</head>
<body>
    <div class="container">
        <h1>Restricted Presentation Team Entry</h1>
        <form id="teamForm">
            <input type="text" id="teamName" placeholder="Enter Team Name" required>
            <input type="text" id="groupNumber" placeholder="Enter Group Number" required>
            <button type="button" onclick="addTeam()">Add Team</button>
        </form>

        <table id="teamTable">
            <tr>
                <th>Team Name</th>
                <th>Group Number</th>
                <th>Actions</th>
            </tr>
        </table>
    </div>

    <script>
        // Set up user ID and admin privileges
        if (!localStorage.getItem("userID")) {
            localStorage.setItem("userID", Math.random().toString(36).substring(2));
        }
        const userID = localStorage.getItem("userID");
        const adminID = "admin123";
        const isAdmin = userID === adminID;

        // Add a new team entry
        function addTeam() {
            const teamName = document.getElementById("teamName").value.trim();
            const groupNumber = document.getElementById("groupNumber").value.trim();

            if (!teamName || !groupNumber) {
                alert("Both fields are required.");
                return;
            }

            const newTeam = { name: teamName, group: groupNumber, creatorID: userID };

            // Update with your new Google Apps Script deployment URL
            const scriptURL = "https://script.google.com/macros/s/AKfycbwJN10zzTqQEY2VQcK7FbwJoRDqMvnPH0qjnHPrRvmTtIl5bFGo71jVThJNL9TiyyEG/exec";

            fetch(scriptURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(newTeam)
            })
            .then(response => response.text())
            .then(responseText => {
                console.log("Response from server:", responseText);  // Log server response for debugging
                if (responseText === "Success") {
                    addTeamToTable(newTeam);
                } else {
                    alert("Error saving team to Google Sheets: " + responseText);
                }
            })
            .catch(error => {
                console.error("Error:", error);
                alert("An error occurred while saving. Check the console for details.");
            });

            document.getElementById("teamForm").reset();
        }

        // Add team to the HTML table
        function addTeamToTable(team) {
            const table = document.getElementById("teamTable");
            const newRow = table.insertRow();
            const nameCell = newRow.insertCell(0);
            const groupCell = newRow.insertCell(1);
            const actionCell = newRow.insertCell(2);

            nameCell.textContent = team.name;
            groupCell.textContent = team.group;

            if (isAdmin) {
                const deleteBtn = document.createElement("button");
                deleteBtn.textContent = "Delete";
                deleteBtn.className = "delete-btn";
                deleteBtn.onclick = function () {
                    deleteTeam(team.name, team.group, newRow);
                };
                actionCell.appendChild(deleteBtn);
            }
        }

        function deleteTeam(teamName, groupNumber, row) {
            row.remove();
            alert("Deleting from Google Sheets is not yet implemented.");
        }
    </script>
</body>
</html>
